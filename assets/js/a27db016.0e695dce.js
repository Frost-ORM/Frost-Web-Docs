"use strict";(self.webpackChunkfrost_web_doc=self.webpackChunkfrost_web_doc||[]).push([[648],{3905:(e,t,n)=>{n.d(t,{Zo:()=>m,kt:()=>c});var a=n(7294);function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},i=Object.keys(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var l=a.createContext({}),p=function(e){var t=a.useContext(l),n=t;return e&&(n="function"==typeof e?e(t):o(o({},t),e)),n},m=function(e){var t=p(e.components);return a.createElement(l.Provider,{value:t},e.children)},u={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},d=a.forwardRef((function(e,t){var n=e.components,r=e.mdxType,i=e.originalType,l=e.parentName,m=s(e,["components","mdxType","originalType","parentName"]),d=p(n),c=r,h=d["".concat(l,".").concat(c)]||d[c]||u[c]||i;return n?a.createElement(h,o(o({ref:t},m),{},{components:n})):a.createElement(h,o({ref:t},m))}));function c(e,t){var n=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var i=n.length,o=new Array(i);o[0]=d;var s={};for(var l in t)hasOwnProperty.call(t,l)&&(s[l]=t[l]);s.originalType=e,s.mdxType="string"==typeof e?e:r,o[1]=s;for(var p=2;p<i;p++)o[p]=n[p];return a.createElement.apply(null,o)}return a.createElement.apply(null,n)}d.displayName="MDXCreateElement"},3563:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>l,contentTitle:()=>o,default:()=>u,frontMatter:()=>i,metadata:()=>s,toc:()=>p});var a=n(7462),r=(n(7294),n(3905));const i={sidebar_position:2,description:"Using the Relation decorator to define the relations between the already defined nodes"},o="Define Relations",s={unversionedId:"docs/fundamentals/define-realtions",id:"version-1.0.3/docs/fundamentals/define-realtions",title:"Define Relations",description:"Using the Relation decorator to define the relations between the already defined nodes",source:"@site/versioned_docs/version-1.0.3/docs/fundamentals/define-realtions.mdx",sourceDirName:"docs/fundamentals",slug:"/docs/fundamentals/define-realtions",permalink:"/frost-web-docs/1.0.3/docs/fundamentals/define-realtions",draft:!1,tags:[],version:"1.0.3",sidebarPosition:2,frontMatter:{sidebar_position:2,description:"Using the Relation decorator to define the relations between the already defined nodes"},sidebar:"tutorialSidebar",previous:{title:"Create a node",permalink:"/frost-web-docs/1.0.3/docs/fundamentals/create-a-node"},next:{title:"Database Operations",permalink:"/frost-web-docs/1.0.3/category/database-operations"}},l={},p=[{value:"One To One",id:"one-to-one",level:2},{value:"One To Many",id:"one-to-many",level:2},{value:"Many To Many",id:"many-to-many",level:2}],m={toc:p};function u(e){let{components:t,...n}=e;return(0,r.kt)("wrapper",(0,a.Z)({},m,n,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("h1",{id:"define-relations"},"Define Relations"),(0,r.kt)("p",null,"In This Section We will list the rules for defining a relation between entities, but if you like you can skip to the guide for each relation type below. But please look at the highlighted parts.\nTo define a relation between two entities:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Define a property in both entities with the type of the other entity."),(0,r.kt)("li",{parentName:"ul"},"Annotate the properties with ",(0,r.kt)("a",{parentName:"li",href:"../../api/decorators/Relation"},"Relation"),".",(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"../../api/types/RelationOptions"},"RelationOptions"),":",(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},(0,r.kt)("em",{parentName:"strong"},"name")),": an unique arbitrary string that could describes the relation and the sides.",(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},"The Two properties on both side should share the same relation name."),(0,r.kt)("li",{parentName:"ul"},"Different relations should have different names."),(0,r.kt)("li",{parentName:"ul"},'The name could be something like "{side1}-{side2}" so "user-profile" or "student-courses".'),(0,r.kt)("li",{parentName:"ul"},"This allows you to have multiple relations between the same data types. So for example, if a user has two profiles ",'[ "secret profile", "public profile" ]'," you could have 2 properties with the same data types but with different relation names."))),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},(0,r.kt)("em",{parentName:"strong"},"relation")),":",(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},"Should be one of the values in the enum ",(0,r.kt)("a",{parentName:"li",href:"../../api/enums/RelationTypes"},"RelationTypes"),"."),(0,r.kt)("li",{parentName:"ul"},"It doesn't have to be defined on both sides, just one side is enough."))),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},(0,r.kt)("em",{parentName:"strong"},"type")),": the data type of the property that is decorated, this is required because of some limitations in the Reflection API in Javascript.",(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},(0,r.kt)("em",{parentName:"strong"},"Due to cyclic dependency the type of the property should a function that returns the desired type. so ",(0,r.kt)("inlineCode",{parentName:"em"},"()=> PropertyType")))),(0,r.kt)("li",{parentName:"ul"},"In the type parameter in the RelationOptions ignore the Array brackets in case of ",(0,r.kt)("inlineCode",{parentName:"li"},"Many")))),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},(0,r.kt)("em",{parentName:"strong"},"master")),":",(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},"One of the sides should be the main (master) side and the other would secondary (slave)."),(0,r.kt)("li",{parentName:"ul"},"In Symmetric Relations (One to One, Many to Many) the order of the master and slave doesn't matter."),(0,r.kt)("li",{parentName:"ul"},"But in Asymmetric Relations (One to Many) the master should be the ",(0,r.kt)("inlineCode",{parentName:"li"},"One")," side and the slave should be the ",(0,r.kt)("inlineCode",{parentName:"li"},"Many")," side."),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},(0,r.kt)("em",{parentName:"strong"},"This parameter is what decides which is the master and which is the slave. it should be equal to true on the master side. the other side could be left unassigned or equal false")))))))))),(0,r.kt)("admonition",{type:"danger"},(0,r.kt)("p",{parentName:"admonition"},(0,r.kt)("strong",{parentName:"p"},(0,r.kt)("em",{parentName:"strong"},"Due to cyclic dependency the type of the property should a function that returns the desired type. so ",(0,r.kt)("inlineCode",{parentName:"em"},"()=> PropertyType"))))),(0,r.kt)("admonition",{type:"info"},(0,r.kt)("p",{parentName:"admonition"},"It is a good practice to use constant variables as the names for the relations, this way you don't have to worry that both side have the exact same string.\nyou can see that in the full example, Constants were used."),(0,r.kt)("p",{parentName:"admonition"},"One way to handle the constants is to define them on the main Entity File with snake case. For example;"),(0,r.kt)("pre",{parentName:"admonition"},(0,r.kt)("code",{parentName:"pre",className:"language-ts",metastring:"file=src/data/user.ts",file:"src/data/user.ts"},'export const USER_PROFILE = "user-profile"\n')),(0,r.kt)("p",{parentName:"admonition"},"you can see it also in the example below.")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-ts"},'// User\nexport const USER_PROFILE = "user-profile"\n\n@FrostEntity(...)\nclass User extends FrostObject<User>{\n  ...\n  @Relation(\n    {\n      name: "User-Profile",\n      relation: RelationTypes.ONE_TO_ONE,\n      type: ()=> Profile,\n    }\n  )\n  profile: () => Profile\n  ...\n}\n\n\n// Profile \nimport {User, USER_PROFILE} from "./user"\n\n@FrostEntity(...)\nclass Profile extends FrostObject<Profile>{\n  ...\n  @Relation(\n    {\n      name: USER_PROFILE,\n      relation: RelationTypes.ONE_TO_ONE, //optional since it\'s already assigned in User Class\n      type: () => User,\n    }\n  )\n  user: ()=> User\n  ...\n}\n')),(0,r.kt)("h2",{id:"one-to-one"},"One To One"),(0,r.kt)("p",null,"We'll Use an example of User and Contact Info to explain the process of defining a one to one relation."),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"../../api/types/RelationOptions"},"RelationOptions"),":",(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},(0,r.kt)("em",{parentName:"strong"},"name")),":",(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},"an unique arbitrary string that could describes the relation and the sides."),(0,r.kt)("li",{parentName:"ul"},'In this example, We wil use "userContactInfo"'))),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},(0,r.kt)("em",{parentName:"strong"},"relation")),":",(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},"the value will be ",(0,r.kt)("a",{parentName:"li",href:"../../api/enums/RelationTypes#ONE_TO_ONE"},"RelationTypes.ONE_TO_ONE"),"."),(0,r.kt)("li",{parentName:"ul"},"you can assign it on either or both sides."),(0,r.kt)("li",{parentName:"ul"},"In this example, We will assign it on the User side."))),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},(0,r.kt)("em",{parentName:"strong"},"type")),":",(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},"Due to cyclic dependency and some limitations in the Reflection API in Javascript.\nyou will have to pass the type as a function that returns the type of the property in the decorator"),(0,r.kt)("li",{parentName:"ul"},"In this example, it will be ",(0,r.kt)("inlineCode",{parentName:"li"},"()=>ContactInfo")," on the User side and ",(0,r.kt)("inlineCode",{parentName:"li"},"()=>User")," on the ContactInfo side."))),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},(0,r.kt)("em",{parentName:"strong"},"master")),": is not required in this case.")))),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-ts",metastring:'title="example/src/data/user.ts" showLineNumbers',title:'"example/src/data/user.ts"',showLineNumbers:!0},'import {ContactInfo} from \'./contact-info\'\n\n@FrostEntity({collectionPath:\'/users\'})\nexport class User extends FrostObject<User>{\n  id!:string;\n  name!:string;\n  userType!: "Buyer"|"Seller";\n\n//highlight-start\n  @Relation(\n    {\n      name: "userContactInfo",\n      relation: RelationTypes.ONE_TO_ONE,\n      type: ()=> ContactInfo,\n    }\n  )\n  contactInfo?: () => ContactInfo;\n//highlight-end\n\n}\n')),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-ts",metastring:'title="example/src/data/contact-info.ts" showLineNumbers',title:'"example/src/data/contact-info.ts"',showLineNumbers:!0},"import {User} from './user'\n\n@FrostEntity({collectionPath:'/contact_info'})\nclass ContactInfo extends FrostObject<ContactInfo>{\n  id!:string;\n  email?:string;\n  address?:string;\n  location?:{lat:string,lng:string};\n  postalCode?:string;\n\n  phones?:{\n    work?:string,\n    home?:string\n  };\n\n  landlines?:{\n    work?:string,\n    home?:string\n  };\n\n//highlight-start\n  @Relation(\n    {\n      name: \"userContactInfo\",\n      type: () => User,\n    }\n  )\n  user?: ()=> User\n//highlight-end\n\n}\n")),(0,r.kt)("h2",{id:"one-to-many"},"One To Many"),(0,r.kt)("p",null,"We'll Use an example of Professors and Courses to explain the process of defining a One to Many relation\n(one professor could teach multiple courses and each course only has one professor)."),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"../../api/types/RelationOptions"},"RelationOptions"),":",(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},(0,r.kt)("em",{parentName:"strong"},"name")),":",(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},"an unique arbitrary string that could describes the relation and the sides."),(0,r.kt)("li",{parentName:"ul"},"In this example, We wil use ",(0,r.kt)("inlineCode",{parentName:"li"},"professor_courses")))),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},(0,r.kt)("em",{parentName:"strong"},"relation")),":",(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},"the value will be ",(0,r.kt)("a",{parentName:"li",href:"../../api/enums/RelationTypes#ONE_TO_MANY"},"RelationTypes.ONE_TO_MANY"),"."),(0,r.kt)("li",{parentName:"ul"},"you can assign it on either or both sides."),(0,r.kt)("li",{parentName:"ul"},"In this example, We will assign it on the Professor side."))),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},(0,r.kt)("em",{parentName:"strong"},"type")),":",(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},"Due to cyclic dependency and some limitations in the Reflection API in Javascript.\nyou will have to pass the type as a function that returns the type of the property in the decorator"),(0,r.kt)("li",{parentName:"ul"},"In this example, it will be ",(0,r.kt)("inlineCode",{parentName:"li"},"()=>Course")," on the Professor side and ",(0,r.kt)("inlineCode",{parentName:"li"},"()=>Professor")," on the Course side."),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},(0,r.kt)("em",{parentName:"strong"},"The property types however should be ",(0,r.kt)("inlineCode",{parentName:"em"},"()=>Course[]")," and ",(0,r.kt)("inlineCode",{parentName:"em"},"()=>Professor")," respectively"))))),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},(0,r.kt)("em",{parentName:"strong"},"master")),":",(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},"Should be assigned as true on the professor side."),(0,r.kt)("li",{parentName:"ul"},"On the Course side, it should be unassigned(ie; ",(0,r.kt)("inlineCode",{parentName:"li"},"undefined"),") or ",(0,r.kt)("inlineCode",{parentName:"li"},"false"))))))),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-ts",metastring:'title="example/src/data/professor.ts" showLineNumbers',title:'"example/src/data/professor.ts"',showLineNumbers:!0},"import {Course} from './course'\n\n@FrostEntity({collectionPath:'/professors'})\nexport class Professor extends FrostObject<Professor>{\n\n  id!:string;\n  name!:string;\n  department!:string;\n\n//highlight-start\n  @Relation(\n    {\n      name: \"professor_courses\",\n      relation: RelationTypes.ONE_TO_MANY,\n      type: ()=> Course,\n    }\n  )\n  courses?: () => Course[];\n//highlight-end\n\n}\n")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-ts",metastring:'title="example/src/data/course.ts" showLineNumbers',title:'"example/src/data/course.ts"',showLineNumbers:!0},"import {Professor} from './professor'\n\n@FrostEntity({collectionPath:'/courses'})\nclass Course extends FrostObject<Course>{\n\n  id!:string;\n  name!:string;\n  difficultyLevel!:number;\n  duration!: number; // in weeks\n\n//highlight-start\n  @Relation(\n    {\n      name: \"professor_courses\",\n      type: () => Professor,\n    }\n  )\n  professor?:() => Professor\n//highlight-end\n\n}\n")),(0,r.kt)("h2",{id:"many-to-many"},"Many To Many"),(0,r.kt)("p",null,"Many to Many is very similar to ",(0,r.kt)("a",{parentName:"p",href:"#one-to-one"},"One To One")," both the properties type return arrays of the entity type.\nWe'll continue on the same example from ",(0,r.kt)("a",{parentName:"p",href:"#one-to-many"},"One To Many"),".\nThe relation we will use to explain the process of defining a Many to Many relation is ",(0,r.kt)("inlineCode",{parentName:"p"},"Student and Courses")," (one student could enroll in multiple courses and one course could have multiple students auditing it)."),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"../../api/types/RelationOptions"},"RelationOptions"),":",(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},(0,r.kt)("em",{parentName:"strong"},"name")),":",(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},"an unique arbitrary string that could describes the relation and the sides."),(0,r.kt)("li",{parentName:"ul"},"In this example, We wil use ",(0,r.kt)("inlineCode",{parentName:"li"},"students_courses")))),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},(0,r.kt)("em",{parentName:"strong"},"relation")),":",(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},"the value will be ",(0,r.kt)("a",{parentName:"li",href:"../../api/enums/RelationTypes#MANY_TO_MANY"},"RelationTypes.MANY_TO_MANY"),"."),(0,r.kt)("li",{parentName:"ul"},"you can assign it on either or both sides."),(0,r.kt)("li",{parentName:"ul"},"In this example, We will assign it on the Student side."))),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},(0,r.kt)("em",{parentName:"strong"},"type")),":",(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},"Due to cyclic dependency and some limitations in the Reflection API in Javascript.\nyou will have to pass the type as a function that returns the type of the property in the decorator"),(0,r.kt)("li",{parentName:"ul"},"In this example, it will be ",(0,r.kt)("inlineCode",{parentName:"li"},"()=>Course")," on the Student side and ",(0,r.kt)("inlineCode",{parentName:"li"},"()=>Student")," on the Course side."),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},(0,r.kt)("em",{parentName:"strong"},"The property types however should be ",(0,r.kt)("inlineCode",{parentName:"em"},"()=>Course[]")," and ",(0,r.kt)("inlineCode",{parentName:"em"},"()=>Student[]")," respectively"))))),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},(0,r.kt)("em",{parentName:"strong"},"master")),": is not required in this case.")))),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-ts",metastring:'title="example/src/data/student.ts" showLineNumbers',title:'"example/src/data/student.ts"',showLineNumbers:!0},'import {Course} from \'./course\'\n\n@FrostEntity({collectionPath:\'/students\'})\nexport class Student extends FrostObject<Student>{\n\n  id!:string;\n  name!:string;\n  year: "FRESHMAN" | "SOPHOMORE" | "JUNIOR" | "SENIOR"\n\n//highlight-start\n  @Relation(\n    {\n      name: "students_courses",\n      relation: RelationTypes.MANY_TO_MANY,\n      type: ()=> Course,\n    }\n  )\n  courses?: () => Course[];\n//highlight-end\n\n}\n')),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-ts",metastring:'title="example/src/data/course.ts" showLineNumbers',title:'"example/src/data/course.ts"',showLineNumbers:!0},"import {Student} from './student'\nimport {Professor} from './professor'\n\n@FrostEntity({collectionPath:'/courses'})\nclass Course extends FrostObject<Course>{\n\n  id!:string;\n  name!:string;\n  difficultyLevel!:number;\n  duration!: number; // in weeks\n\n//one to many example (slave side)\n  @Relation(\n    {\n      name: \"professor_courses\",\n      type: () => Professor,\n    }\n  )\n  professor?:() => Professor\n\n//highlight-start\n  @Relation(\n    {\n      name: \"students_courses\",\n      type: () => Student,\n    }\n  )\n  students?: ()=> Student[]\n//highlight-end\n\n}\n")))}u.isMDXComponent=!0}}]);